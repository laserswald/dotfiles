#!/bin/sh
dir="$HOME/.config/alacritty"
theme="$dir/theme.m4"
file="$dir/alacritty.yml.m4"

if [ -L "$file" ]
then
	file=$(realpath $file)
fi
if [ -L "$theme" ]
then
	theme=$(realpath $theme)
fi

definitions=

while getopts "dlf:s:t:" flag;
do
	case $flag in
		d)
			definitions="$definitions--define=SHADE=\"dark\" "
			;;
		l)
			definitions="$definitions--define=SHADE=\"light\" "
			;;
		f)
			definitions="$definitions\"-D_FONT=${OPTARG}\" "
			;;
		s)
			definitions="$definitions\"-D_FONT_SIZE=${OPTARG}\" "
			;;
		t)
			definitions="$definitions\"-DCURRENT_THEME=theme_${OPTARG}\" "
			;;
	esac
done

echo m4 "$definitions" "$theme" "$file"
m4 -d "$definitions" "$theme" "$file" >"$dir/alacritty.yml"

