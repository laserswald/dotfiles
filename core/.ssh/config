#
# OpenSSH configuration 
#

# Sol.
# The VPN orbits around this.

# Attempt to connect using VPN
Match host sol exec "nc -w 1 -z sol.lazr.internal %p"
  Hostname sol.lazr.internal

# Fine, just resolve it with the real DNS.  
Match host sol
  Hostname lazr.space
  
Host sol
  User lazr

## Andromeda.
## Hosts a galaxy of VMs, services, etc.

# Attempt to connect using home DNS
Match host andromeda exec "nc -w 1 -z andromeda.home.arpa %p"
  Hostname andromeda.home.arpa

# Attempt to connect using avahi discovery
Match host andromeda exec "nc -w 1 -z andromeda.local %p"
  Hostname andromeda.local

# Attempt to connect using pre-defined LAN IP
Match host andromeda exec "nc -w 1 -z 192.168.1.3 %p"
  Hostname 192.168.1.3

# Attempt to connect using VPN
Match host andromeda exec "nc -w 1 -z andromeda.lazr.internal %p"
  Hostname andromeda.lazr.internal

Host andromeda  
  User ben 

## Baked.
## A tiny host (it's a potato, get it?)
    
# Attempt to connect using home DNS
Match host baked exec "nc -w 1 -z baked.home.arpa %p"
  Hostname baked.home.arpa

# Attempt to connect using avahi discovery
Match host baked exec "nc -w 1 -z baked.local %p"
  Hostname baked.local

# Attempt to connect using pre-defined LAN IP
Match host baked exec "nc -w 1 -z 192.168.1.2 %p"
  Hostname 192.168.1.2

# Attempt to connect using VPN
Match host baked exec "nc -w 1 -z baked.lazr.internal %p"
  Hostname baked.lazr.internal

Host baked  
  User ben 

  
# All hosts, by default.
Host *
  AddKeysToAgent yes
  ForwardAgent yes
  IdentityFile ~/.ssh/%L_ed25519
